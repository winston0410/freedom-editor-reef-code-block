var t,e={getSavedData:t=>t?t.data.code:""},n=["checked","selected","value"],r={},a=!1,o=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()};r.trueTypeOf=o;var i=function(t){if(a)throw new Error(t)};r.err=i;var c=function(t,e){var n=o(t);if("object"===n){var r={};for(var a in t)t.hasOwnProperty(a)&&(r[a]=c(t[a],e));return r}if("array"===n)return t.map((function(t){return c(t,e)}));if("string"===n&&!e){var i=document.createElement("div");return i.textContent=t,i.innerHTML}return t},l=function(t){t.debounce&&window.cancelAnimationFrame(t.debounce),t.debounce=window.requestAnimationFrame((function(){t.render()}))},u=function(t){return{get:function(e,n){return["object","array"].indexOf(o(e[n]))>-1?new Proxy(e[n],u(t)):e[n]},set:function(e,n,r){return e[n]===r||(e[n]=r,l(t)),!0}}},s=function(t,e){var n=t.filter(e);return n.length<1?null:n[0]},d=function(t,e){if(!(t||e&&e.lagoon))return i("You did not provide an element to make into a component.");if(!e||!e.template&&!e.lagoon)return i("You did not provide a template for this component.");var n=this,r=function(t,e){return t.setters?t.store?null:t.data:t.data&&!t.store?new Proxy(t.data,u(e)):null}(e,n),a=e.store,s=e.router,d=e.setters,f=e.getters;n.debounce=null,Object.defineProperties(n,{elem:{value:t},template:{value:e.template},allowHTML:{value:e.allowHTML},lagoon:{value:e.lagoon},store:{value:a},attached:{value:[]},router:{value:s}}),Object.defineProperty(n,"data",{get:function(){return d?c(r,!0):r},set:function(t){return a||d||(r=new Proxy(t,u(n)),l(n)),!0}}),d&&!a&&Object.defineProperty(n,"do",{value:function(t){if(!d[t])return i("There is no setter with this name.");var e=Array.prototype.slice.call(arguments);e[0]=r,d[t].apply(n,e),l(n)}}),f&&!a&&Object.defineProperty(n,"get",{value:function(t){return f[t]?f[t](r):i("There is no getter with this name.")}}),s&&"addComponent"in s&&s.addComponent(n),a&&"attach"in a&&a.attach(n),e.attachTo&&("array"===o(e.attachTo)?e.attachTo:[e.attachTo]).forEach((function(t){"attach"in t&&t.attach(n)}))};d.Store=function(t){return t.lagoon=!0,new d(null,t)};var f=function(t,e){e.forEach((function(e){t.style[e]=""}))},h=function(t,e){e.forEach((function(e){if("class"===e.att)t.className=e.value;else if("style"===e.att)!function(t,e){var n=function(t){return t.split(";").reduce((function(t,e){var n=e.indexOf(":");return n&&t.push({name:e.slice(0,n).trim(),value:e.slice(n+1).trim()}),t}),[])}(e),r=Array.prototype.filter.call(t.style,(function(e){return null===s(n,(function(n){return n.name===e&&n.value===t.style[e]}))}));f(t,r),function(t,e){e.forEach((function(e){t.style[e.name]=e.value}))}(t,n)}(t,e.value);else{if(e.att in t)try{t[e.att]=e.value,t[e.att]||0===t[e.att]||(t[e.att]=!0)}catch(t){}try{t.setAttribute(e.att,e.value)}catch(t){}}}))},p=function(t,e){e.forEach((function(e){if("class"===e.att)t.className="";else if("style"===e.att)f(t,Array.prototype.slice.call(t.style));else{if(e.att in t)try{t[e.att]=""}catch(t){}try{t.removeAttribute(e.att)}catch(t){}}}))},m=function(t,e){return{att:t,value:e}},v=function(t,e){if(1!==t.nodeType)return[];var r=function(t,e){return Array.prototype.reduce.call(t.attributes,(function(t,r){return!(n.indexOf(r.name)<0||e&&"selected"===r.name)||r.name.length>7&&"default"===r.name.slice(0,7)||t.push(m(r.name,r.value)),t}),[])}(t,e);return function(t,e,r){n.forEach((function(n){!t[n]&&0!==t[n]||r&&"option"===t.tagName.toLowerCase()&&"selected"===n||r&&"select"===t.tagName.toLowerCase()&&"value"===n||e.push(m(n,t[n]))}))}(t,r,e),r},y=function(t){return 3===t.nodeType?"text":8===t.nodeType?"comment":t.tagName.toLowerCase()},g=function(t){return t.childNodes&&t.childNodes.length>0?null:t.textContent},w=function(t){1===t.nodeType&&(Array.prototype.forEach.call(t.attributes,(function(e){e.name.length<8||"default"!==e.name.slice(0,7)||(h(t,[m(e.name.slice(7).toLowerCase(),e.value)]),p(t,[m(e.name,e.value)]))})),t.childNodes&&Array.prototype.forEach.call(t.childNodes,(function(t){w(t)})))},b=function(t,e,r){var a=Array.prototype.slice.call(e.childNodes),o=Array.prototype.slice.call(t.childNodes),i=a.length-o.length;if(i>0)for(;i>0;i--)a[a.length-i].parentNode.removeChild(a[a.length-i]);o.forEach((function(t,o){if(!a[o])return w(t),void e.appendChild(t.cloneNode(!0));if(y(t)===y(a[o])){if(function(t,e){var r=v(t,!0),a=v(e),o=a.filter((function(t){return!(n.indexOf(t.att)>-1)&&null===s(r,(function(e){return t.att===e.att}))})),i=r.filter((function(t){var e=s(a,(function(e){return t.att===e.att}));return null===e||e.value!==t.value}));h(e,i),p(e,o)}(t,a[o]),!(r.filter((function(e){return 3!==t.nodeType&&function(t,e){return Element.prototype.matches&&t.matches(e)||Element.prototype.msMatchesSelector&&t.msMatchesSelector(e)||Element.prototype.webkitMatchesSelector&&t.webkitMatchesSelector(e)}(t,e)})).length>0)){var i=g(t);if(i&&i!==g(a[o])&&(a[o].textContent=i),a[o].childNodes.length>0&&t.childNodes.length<1)a[o].innerHTML="";else{if(a[o].childNodes.length<1&&t.childNodes.length>0){var c=document.createDocumentFragment();return b(t,c,r),void a[o].appendChild(c)}t.childNodes.length>0&&b(t,a[o],r)}}}else a[o].parentNode.replaceChild(t.cloneNode(!0),a[o])}))},N=function(t,e){t&&t.forEach((function(t){if(t.attached.indexOf(e)>-1)return i(e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))};d.emit=function(t,e,n){var r;if(!t||!e)return i("You did not provide an element or event name.");r=new CustomEvent(e,{bubbles:!0,detail:n}),t.dispatchEvent(r)},d.prototype.render=function(){if(this.lagoon)N(this.attached,this);else{if(!this.template)return i("No template was provided.");var e="string"===o(this.elem)?document.querySelector(this.elem):this.elem;if(!e)return i("The DOM element to render your template into was not found.");var n=c((this.store?this.store.data:this.data)||{},this.allowHTML),r="function"===o(this.template)?this.template(n,this.router?this.router.current:null):this.template;if(!(["string","number"].indexOf(o(r))<0)){var a=this.attached.map((function(t){return t.elem}));return b(function(e){if(t){var n=(new DOMParser).parseFromString(e,"text/html");return"head"in n&&"childNodes"in n.head&&n.head.childNodes.length>0&&Array.prototype.slice.call(n.head.childNodes).reverse().forEach((function(t){n.body.insertBefore(t,n.body.firstChild)})),n.body}var r=document.createElement("div");return r.innerHTML=e,r}(r),e,a),d.emit(e,"render",n),N(this.attached,this),e}}},d.prototype.attach=function(t){"array"===o(t)?this.attached.concat(t):this.attached.push(t)},d.prototype.detach=function(t){var e="array"===o(t)?t:[t],n=this;e.forEach((function(t){var e=n.attached.indexOf(t);e<0||n.attached.splice(e,1)}))},d.debug=function(t){a=!!t},d.clone=c,d._=r,t=function(){if(!window.DOMParser)return!1;var t=new DOMParser;try{t.parseFromString("x","text/html")}catch(t){return!1}return!0}();const{getSavedData:E}=e;var x={Code:class{constructor(t){this.options={i18n:{locale:"en-US",rtl:"ltr",translations:{}},controllers:[],...t}}render(t,e){const n=document.createElement("div");n.classList.add("freedom-editor-blocks",this.constructor.name+"-block"),n.dataset.blockType=this.constructor.name;return new d(n,{data:{savedData:e},template:()=>`<pre>\n          <code contenteditable>${E(e)}</code>\n          </pre>`}).render()}save(t){const e=t.querySelector("code");if(""!==e.textContent)return{type:this.constructor.name,data:{code:e.textContent}}}}};export default x;
